"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[8634],{8703:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>d,metadata:()=>n,toc:()=>o});var n=s(3809),t=s(4848),i=s(8453);const d={layout:"single",title:"AKS terraform\uc73c\ub85c \uc2dc\uc791\ud574\ubcf4\uae30",date:"2024-10-26 16:16:01 -0600",categories:"work",tags:["Redis Cluster","kubernetes"],author_profile:!1,toc:!0,toc_label:"On This Page",toc_icon:"cog",toc_position:"sticky",authors:["hansgun"]},a="Prolog",c={authorsImageUrls:[void 0]},o=[{value:"1-1. \ud30c\uc77c \uad6c\uc870",id:"1-1-\ud30c\uc77c-\uad6c\uc870",level:2},{value:"1-2. \uc804\uccb4 \ud750\ub984 - <code>az_terra.sh</code>",id:"1-2-\uc804\uccb4-\ud750\ub984---az_terrash",level:2},{value:"1-3. Terraform \uc124\uc815 \uac12",id:"1-3-terraform-\uc124\uc815-\uac12",level:2},{value:"1-3-1. README.md file \ub0b4\uc6a9 - <code>terraform-docs</code> \uc0dd\uc131\ud30c\uc77c",id:"1-3-1-readmemd-file-\ub0b4\uc6a9---terraform-docs-\uc0dd\uc131\ud30c\uc77c",level:3},{value:"Requirements",id:"requirements",level:3},{value:"Providers",id:"providers",level:3},{value:"Modules",id:"modules",level:3},{value:"Resources",id:"resources",level:3},{value:"Inputs",id:"inputs",level:3},{value:"Outputs",id:"outputs",level:3},{value:"1-3-2. <code>0-variables.tf</code> \ud30c\uc77c \ub0b4\uc6a9 \uc911 \ubcc0\uacbd \uc0ac\ud56d",id:"1-3-2-0-variablestf-\ud30c\uc77c-\ub0b4\uc6a9-\uc911-\ubcc0\uacbd-\uc0ac\ud56d",level:3},{value:"1-3-3. <code>1_providers.tf</code>",id:"1-3-3-1_providerstf",level:3},{value:"1-3-4. <code>2_ssh.tf</code> : \ubcc0\uacbd\uc0ac\ud56d \uc5c6\uc74c",id:"1-3-4-2_sshtf--\ubcc0\uacbd\uc0ac\ud56d-\uc5c6\uc74c",level:3},{value:"1-3-5. <code>3_main.tf</code>",id:"1-3-5-3_maintf",level:3},{value:"1-3-6. <code>7_output.tf</code> : \ubcc0\uacbd \uc5c6\uc74c",id:"1-3-6-7_outputtf--\ubcc0\uacbd-\uc5c6\uc74c",level:3},{value:"2. Terraform \uc2e4\uc0dd",id:"2-terraform-\uc2e4\uc0dd",level:2},{value:"7. [\ucc38\uace0 \uc0ac\uc774\ud2b8]",id:"7-\ucc38\uace0-\uc0ac\uc774\ud2b8",level:2},{value:"8. Epilog",id:"8-epilog",level:2}];function l(e){const r={a:"a",blockquote:"blockquote",code:"code",del:"del",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r.blockquote,{children:["\n",(0,t.jsx)(r.p,{children:"summary"}),"\n"]}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Prometheus\ub97c k8s cluster\uc5d0 \uc124\uce58\ud558\ub294 \uc2e4\uc2b5\uc744 \uc9c4\ud589\ud558\uace0\uc790 \uc124\uce58 \ud658\uacbd\uc744 \uc54c\uc544\ubcf4\ub358 \uc911, Azure\uc758 \ubb34\ub8cc credit\uc774 \uc788\uc5b4 AKS\ub97c \uc124\uce58\ud574 \ubcf4\uc558\ub2e4."}),"\n",(0,t.jsxs)(r.li,{children:["\ud3c9\uc18c \uc2e4\uc2b5\ud574\ubcf4\uace0\uc790 \ud588\ub358 ",(0,t.jsx)(r.code,{children:"Terraform"})," \uc744 \uc774\uc6a9\ud558\uc5ec Provisioning \ud558\ub294 history\ub97c \uae30\ub85d\uc5d0 \ub0a8\uae30\uace0\uc790 \uc791\uc131\ud55c blog \uc774\ub2e4."]}),"\n",(0,t.jsx)(r.li,{children:"\uc2e4\uc81c \uc791\uc5c5 \ud6c4 2\uac1c\uc6d4 \uc774\ud6c4\uc5d0 \uc791\uc131\ud558\ub294 \ub0b4\uc6a9\uc774\ub77c \uae30\uc5b5\uc774 \uac00\ubb3c\uac00\ubb3c \ud558\ub2e4..."}),"\n"]}),"\n",(0,t.jsx)(r.h1,{id:"1-\uac1c-\uc694",children:"1. \uac1c \uc694"}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"Prometheus - [ kube-prometheus-stack ]"}),"\n",(0,t.jsx)(r.li,{children:"Loki - for log"}),"\n",(0,t.jsx)(r.li,{children:"Tempo, Opentelemetry Agent - for trace"}),"\n",(0,t.jsx)(r.li,{children:"Exporters - Redis, PostgreSQL"}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"1-1-\ud30c\uc77c-\uad6c\uc870",children:"1-1. \ud30c\uc77c \uad6c\uc870"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"$ tree\n.\n\u251c\u2500\u2500 az_terra.sh\n\u2514\u2500\u2500 terraform\n    \u251c\u2500\u2500 0_variables.tf\n    \u251c\u2500\u2500 1_providers.tf\n    \u251c\u2500\u2500 2_ssh.tf\n    \u251c\u2500\u2500 3_main.tf\n    \u251c\u2500\u2500 7_output.tf\n    \u251c\u2500\u2500 main.tfplan\n    \u251c\u2500\u2500 terraform.tfstate\n    \u2514\u2500\u2500 terraform.tfstate.backup\n"})}),"\n",(0,t.jsxs)(r.h2,{id:"1-2-\uc804\uccb4-\ud750\ub984---az_terrash",children:["1-2. \uc804\uccb4 \ud750\ub984 - ",(0,t.jsx)(r.code,{children:"az_terra.sh"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:'export USERNAME=********@hotmail.com\naz account list --query "[?user.name==\'********@hotmail.com\'].{Name:name, ID:id, Default:isDefault}" --output Table\n\naz group  list --query "[?location==\'koreacentral\']"\n\n[\n  {\n    "cloudName": "AzureCloud",\n    "homeTenantId": "b42795af-74d2-****-*****-****",\n    "id": "9e7c5e29-60c3-4a20-8afd-*********",\n    "isDefault": true,\n    "managedByTenants": [],\n    "name": "Microsoft Azure \uc2a4\ud3f0\uc11c\uc27d 2",\n    "state": "Enabled",\n    "tenantId": "b42795af-74d2-****-*****-****",\n    "user": {\n      "name": "********@hotmail.com",\n      "type": "user"\n    }\n  }\n]\n\n## \nexport MSYS_NO_PATHCONV=1\n\naz account set --subscription "9e7c5e29-60c3-******-****-********"\n\naz ad sp create-for-rbac --name vmss_rbac --role Contributor --scopes /subscriptions/9e7c5e29-60c3-******-****-********\n\n{\n  "appId": "a887e74b-****-4ae5-84d6-********",\n  "displayName": "vmss_rbac",\n  "password": "q5b8Q~D&&&&&&*****jec_k",\n  "tenant": "b42795af-74d2-****-*****-****"\n}\n\n\nexport ARM_SUBSCRIPTION_ID="9e7c5e29-60c3-******-****-********"\nexport ARM_TENANT_ID="b42795af-74d2-****-*****-****"\nexport ARM_CLIENT_ID="a887e74b-****-4ae5-84d6-********"\nexport ARM_CLIENT_SECRET="q5b8Q~D&&&&&&*****jec_k"\n\n\naz ad sp create-for-rbac --name <service_principal_name> --role Contributor --scopes /subscriptions/<subscription_id>\n\n\nprovider "azurerm" {\n  features {}\n\n  subscription_id   = "9e7c5e29-60c3-******-****-********"\n  tenant_id         = "b42795af-74d2-****-*****-****"\n  client_id         = "a887e74b-****-4ae5-84d6-********"\n  client_secret     = "q5b8Q~D&&&&&&*****jec_k"\n}\n\nclient_certificate = <sensitive>\nclient_key = <sensitive>\ncluster_ca_certificate = <sensitive>\ncluster_password = <sensitive>\ncluster_username = <sensitive>\nhost = <sensitive>\nkey_data = "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCuQxKT5JhDZD+************/r11DJCx/SlwguHFucV3R+wQSF7/3WwZaqANUS/ArN+zUoAjqmST/UfaJ5JBg4aehoHmzzzhVn/cqA3V31V2rJog5siIYYFFan19VgxsqS3/QH9kxU0/QjQ3PqLOe0hPrbENpnJ8t1BgszokaTPToaJrCMIoCzgY7mBWVnseqgG6qU8vowMM**************tmFKD/tCylxBTecfAsbJBiJt5lcx8eF5dIS**************I7IhAyeHKicexZbt82Lxu6tXwJERYBQ5lkX4Kp************iMuJQ9QEChPCKveKlmU+Tlg3n1P0fNbCo+oWCdRuP6hm4HrU/+Z**********rCCU= generated-by-azure"\nkube_config = <sensitive>\nkubernetes_cluster_name = "cluster-diverse-bear"\nresource_group_name = "rg-premium-koala"\n'})}),"\n",(0,t.jsx)(r.h2,{id:"1-3-terraform-\uc124\uc815-\uac12",children:"1-3. Terraform \uc124\uc815 \uac12"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsxs)(r.li,{children:[(0,t.jsx)(r.code,{children:"terraform-docs"}),"\ub85c \uc0dd\uc131\ud568"]}),"\n"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"$ brew install terraform-docs\n...\n$ terraform-docs markdown table \\\n    --output-file README.md \\\n    --output-mode inject \\\n    .\n\nREADME.md updated successfully\n"})}),"\n",(0,t.jsxs)(r.h3,{id:"1-3-1-readmemd-file-\ub0b4\uc6a9---terraform-docs-\uc0dd\uc131\ud30c\uc77c",children:["1-3-1. README.md file \ub0b4\uc6a9 - ",(0,t.jsx)(r.code,{children:"terraform-docs"})," \uc0dd\uc131\ud30c\uc77c"]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsxs)(r.blockquote,{children:["\n",(0,t.jsx)(r.h3,{id:"requirements",children:"Requirements"}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Name"}),(0,t.jsx)(r.th,{children:"Version"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"requirement_terraform"})," ",(0,t.jsx)(r.a,{href:"#requirement_terraform",children:"terraform"})]}),(0,t.jsx)(r.td,{children:">=1.0"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"requirement_azapi"})," ",(0,t.jsx)(r.a,{href:"#requirement_azapi",children:"azapi"})]}),(0,t.jsx)(r.td,{children:"~>1.5"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"requirement_azurerm"})," ",(0,t.jsx)(r.a,{href:"#requirement_azurerm",children:"azurerm"})]}),(0,t.jsx)(r.td,{children:"~>3.0"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"requirement_random"})," ",(0,t.jsx)(r.a,{href:"#requirement_random",children:"random"})]}),(0,t.jsx)(r.td,{children:"~>3.0"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"requirement_time"})," ",(0,t.jsx)(r.a,{href:"#requirement_time",children:"time"})]}),(0,t.jsx)(r.td,{children:"0.9.1"})]})]})]}),"\n",(0,t.jsx)(r.h3,{id:"providers",children:"Providers"}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Name"}),(0,t.jsx)(r.th,{children:"Version"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"provider_azapi"})," ",(0,t.jsx)(r.a,{href:"#provider_azapi",children:"azapi"})]}),(0,t.jsx)(r.td,{children:"1.12.1"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"provider_azurerm"})," ",(0,t.jsx)(r.a,{href:"#provider_azurerm",children:"azurerm"})]}),(0,t.jsx)(r.td,{children:"3.93.0"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"provider_random"})," ",(0,t.jsx)(r.a,{href:"#provider_random",children:"random"})]}),(0,t.jsx)(r.td,{children:"3.6.0"})]})]})]}),"\n",(0,t.jsx)(r.h3,{id:"modules",children:"Modules"}),"\n",(0,t.jsx)(r.p,{children:"No modules."}),"\n",(0,t.jsx)(r.h3,{id:"resources",children:"Resources"}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Name"}),(0,t.jsx)(r.th,{children:"Type"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:["[azapi_resource.ssh_public_key](",(0,t.jsx)(r.a,{href:"https://registry.terraform.io/providers/azure/azapi/latest/docs/resources/%3E",children:"https://registry.terraform.io/providers/azure/azapi/latest/docs/resources/>"})," resource)"]}),(0,t.jsx)(r.td,{children:"resource"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:["[azapi_resource_action.ssh_public_key_gen](",(0,t.jsx)(r.a,{href:"https://registry.terraform.io/providers/azure/azapi/latest/docs/%3E",children:"https://registry.terraform.io/providers/azure/azapi/latest/docs/>"})," resources/resource_action)"]}),(0,t.jsx)(r.td,{children:"resource"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:["[azurerm_kubernetes_cluster.k8s](",(0,t.jsx)(r.a,{href:"https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/%3E",children:"https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/>"})," resources/kubernetes_cluster)"]}),(0,t.jsx)(r.td,{children:"resource"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:["[azurerm_resource_group.rg](",(0,t.jsx)(r.a,{href:"https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/%3E",children:"https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/>"})," resources/resource_group)"]}),(0,t.jsx)(r.td,{children:"resource"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:["[random_pet.azurerm_kubernetes_cluster_dns_prefix](",(0,t.jsx)(r.a,{href:"https://registry.terraform.io/providers/hashicorp/%3E",children:"https://registry.terraform.io/providers/hashicorp/>"})," random/latest/docs/resources/pet)"]}),(0,t.jsx)(r.td,{children:"resource"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:["[random_pet.azurerm_kubernetes_cluster_name](",(0,t.jsx)(r.a,{href:"https://registry.terraform.io/providers/hashicorp/random/%3E",children:"https://registry.terraform.io/providers/hashicorp/random/>"})," latest/docs/resources/pet)"]}),(0,t.jsx)(r.td,{children:"resource"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.td,{children:(0,t.jsx)(r.a,{href:"https://registry.terraform.io/providers/hashicorp/random/latest/docs/resources/pet",children:"random_pet.rg_name"})}),(0,t.jsx)(r.td,{children:"> resource"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:["[random_pet.ssh_key_name](",(0,t.jsx)(r.a,{href:"https://registry.terraform.io/providers/hashicorp/random/latest/docs/resources/%3E",children:"https://registry.terraform.io/providers/hashicorp/random/latest/docs/resources/>"})," pet)"]}),(0,t.jsx)(r.td,{children:"resource"})]})]})]}),"\n",(0,t.jsx)(r.h3,{id:"inputs",children:"Inputs"}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Name"}),(0,t.jsx)(r.th,{children:"Description"}),(0,t.jsx)(r.th,{children:"Type"}),(0,t.jsx)(r.th,{children:"Default"}),(0,t.jsx)(r.th,{style:{textAlign:"center"},children:"Required"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"input_msi_id"})," ",(0,t.jsx)(r.a,{href:"#input_msi_id",children:"msi_id"})]}),(0,t.jsx)(r.td,{children:"The Managed Service Identity ID. Set this value > if you're running this example using Managed Identity as the authentication method."}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"string"})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"null"})}),(0,t.jsx)(r.td,{style:{textAlign:"center"},children:"> no"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"input_node_count"})," ",(0,t.jsx)(r.a,{href:"#input_node_count",children:"node_count"})]}),(0,t.jsx)(r.td,{children:"The initial quantity of nodes for the > node pool."}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"number"})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"2"})}),(0,t.jsx)(r.td,{style:{textAlign:"center"},children:"no"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"input_resource_group_location"})," [resource_group_location]> (#input_resource_group_location)"]}),(0,t.jsx)(r.td,{children:"Location of the resource group."}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"string"})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:'"koreacentral"'})}),(0,t.jsx)(r.td,{style:{textAlign:"center"},children:"no"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"input_resource_group_name_prefix"})," [resource_group_name_prefix]> (#input_resource_group_name_prefix)"]}),(0,t.jsx)(r.td,{children:"Prefix of the resource group name that's combined with a random ID > so name is unique in your Azure subscription."}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:"string"})}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:'"rg"'})}),(0,t.jsx)(r.td,{style:{textAlign:"center"},children:"no"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"input_username"})," ",(0,t.jsx)(r.a,{href:"#input_username",children:"username"})]}),(0,t.jsx)(r.td,{children:"The admin username for the new cluster."}),(0,t.jsxs)(r.td,{children:["> ",(0,t.jsx)(r.code,{children:"string"})]}),(0,t.jsx)(r.td,{children:(0,t.jsx)(r.code,{children:'"azureadmin"'})}),(0,t.jsx)(r.td,{style:{textAlign:"center"},children:"no"})]})]})]}),"\n",(0,t.jsx)(r.h3,{id:"outputs",children:"Outputs"}),"\n",(0,t.jsxs)(r.table,{children:[(0,t.jsx)(r.thead,{children:(0,t.jsxs)(r.tr,{children:[(0,t.jsx)(r.th,{children:"Name"}),(0,t.jsx)(r.th,{children:"Description"})]})}),(0,t.jsxs)(r.tbody,{children:[(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"output_client_certificate"})," ",(0,t.jsx)(r.a,{href:"#output_client_certificate",children:"client_certificate"})]}),(0,t.jsx)(r.td,{children:"n/a"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"output_client_key"})," ",(0,t.jsx)(r.a,{href:"#output_client_key",children:"client_key"})]}),(0,t.jsx)(r.td,{children:"n/a"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"output_cluster_ca_certificate"})," [cluster_ca_certificate]> (#output_cluster_ca_certificate)"]}),(0,t.jsx)(r.td,{children:"n/a"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"output_cluster_password"})," ",(0,t.jsx)(r.a,{href:"#output_cluster_password",children:"cluster_password"})]}),(0,t.jsx)(r.td,{children:"n/a"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"output_cluster_username"})," ",(0,t.jsx)(r.a,{href:"#output_cluster_username",children:"cluster_username"})]}),(0,t.jsx)(r.td,{children:"n/a"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"output_host"})," ",(0,t.jsx)(r.a,{href:"#output_host",children:"host"})]}),(0,t.jsx)(r.td,{children:"n/a"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"output_key_data"})," ",(0,t.jsx)(r.a,{href:"#output_key_data",children:"key_data"})]}),(0,t.jsx)(r.td,{children:"n/a"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"output_kube_config"})," ",(0,t.jsx)(r.a,{href:"#output_kube_config",children:"kube_config"})]}),(0,t.jsx)(r.td,{children:"n/a"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"output_kubernetes_cluster_name"})," [kubernetes_cluster_name]> (#output_kubernetes_cluster_name)"]}),(0,t.jsx)(r.td,{children:"n/a"})]}),(0,t.jsxs)(r.tr,{children:[(0,t.jsxs)(r.td,{children:[(0,t.jsx)("a",{name:"output_resource_group_name"})," ",(0,t.jsx)(r.a,{href:"#output_resource_group_name",children:"resource_group_name"})]}),(0,t.jsx)(r.td,{children:"n/a"})]})]})]}),"\n"]}),"\n",(0,t.jsx)(r.hr,{}),"\n",(0,t.jsxs)(r.h3,{id:"1-3-2-0-variablestf-\ud30c\uc77c-\ub0b4\uc6a9-\uc911-\ubcc0\uacbd-\uc0ac\ud56d",children:["1-3-2. ",(0,t.jsx)(r.code,{children:"0-variables.tf"})," \ud30c\uc77c \ub0b4\uc6a9 \uc911 \ubcc0\uacbd \uc0ac\ud56d"]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-hcl",children:'variable "resource_group_location" {\n  type        = string\n  default     = "koreacentral"  ###### region \uc124\uc815 ######\n  description = "Location of the resource group."\n}\n\n\nvariable "node_count" {\n  type        = number\n  description = "The initial quantity of nodes for the node pool."\n  default     = 2  ###### cluster node \uac2f\uc218 \uc124\uc815 : minimal \uc124\uc815 ######\n}\n\n\nvariable "username" {\n  type        = string\n  description = "The admin username for the new cluster."\n  default     = "azureadmin" ###### username for cluster (default value \uadf8\ub300\ub85c \uc774\uc6a9) ######\n}\n'})}),"\n",(0,t.jsxs)(r.h3,{id:"1-3-3-1_providerstf",children:["1-3-3. ",(0,t.jsx)(r.code,{children:"1_providers.tf"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-hcl",children:'terraform {\n  required_version = ">=1.0"\n\n  required_providers {\n    azapi = {\n      source  = "azure/azapi"\n      version = "~>1.5"\n    }\n    azurerm = {\n      source  = "hashicorp/azurerm"\n      version = "~>3.0"\n    }\n    random = {\u3139\n      source  = "hashicorp/random"\n      version = "~>3.0"\n    }\n    time = {\n      source  = "hashicorp/time"\n      version = "0.9.1"\n    }\n  }\n}\n\nprovider "azurerm" {\n  features {}\n\n  subscription_id   = "9e7c5e29-60c3-******-****-********"  ###### \uc124\uc815\uc5d0 \ub9de\uac8c \ubcc0\uacbd\ud568 ######\n  tenant_id         = "b42795af-74d2-****-*****-****"       ###### \uc124\uc815\uc5d0 \ub9de\uac8c \ubcc0\uacbd\ud568 ######\n  client_id         = "a887e74b-****-4ae5-84d6-********"    ###### \uc124\uc815\uc5d0 \ub9de\uac8c \ubcc0\uacbd\ud568 ######\n  client_secret     = "q5b8Q~D&&&&&&*****jec_k"             ###### \uc124\uc815\uc5d0 \ub9de\uac8c \ubcc0\uacbd\ud568 ######\n}\n\n'})}),"\n",(0,t.jsxs)(r.h3,{id:"1-3-4-2_sshtf--\ubcc0\uacbd\uc0ac\ud56d-\uc5c6\uc74c",children:["1-3-4. ",(0,t.jsx)(r.code,{children:"2_ssh.tf"})," : \ubcc0\uacbd\uc0ac\ud56d \uc5c6\uc74c"]}),"\n",(0,t.jsxs)(r.h3,{id:"1-3-5-3_maintf",children:["1-3-5. ",(0,t.jsx)(r.code,{children:"3_main.tf"})]}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-hcl",children:'....(\uc0dd\ub7b5)....\n\n  default_node_pool {\n    name       = "agentpool"          ###### pool \uc774\ub984 \uc124\uc815 ######\n    vm_size    = "Standard_D2_v2"     ###### vm size \uc124\uc815 ######\n    node_count = var.node_count\n  }\n....(\uc0dd\ub7b5)....\n'})}),"\n",(0,t.jsxs)(r.h3,{id:"1-3-6-7_outputtf--\ubcc0\uacbd-\uc5c6\uc74c",children:["1-3-6. ",(0,t.jsx)(r.code,{children:"7_output.tf"})," : \ubcc0\uacbd \uc5c6\uc74c"]}),"\n",(0,t.jsx)(r.h2,{id:"2-terraform-\uc2e4\uc0dd",children:"2. Terraform \uc2e4\uc0dd"}),"\n",(0,t.jsx)(r.mermaid,{value:"graph LR;\n  A[terraform init] -.-> B[terraform plan] -.-> C[terraform apply] -.-> D[terraform destroy];\n  A -.-> E[terraform validate] -.-> B;\n  C -.-> F[terraform output] -.-> G[terraform show];\n  G -.-> D;"}),"\n",(0,t.jsx)(r.pre,{children:(0,t.jsx)(r.code,{className:"language-bash",children:"$ terraform init \n$ terraform plan \n$ terraform apply \n"})}),"\n",(0,t.jsx)(r.h2,{id:"7-\ucc38\uace0-\uc0ac\uc774\ud2b8",children:"7. [\ucc38\uace0 \uc0ac\uc774\ud2b8]"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:(0,t.jsx)(r.del,{children:"\uae30\uc5b5\uc774 \uc548\ub0a8"})}),"\n"]}),"\n",(0,t.jsx)(r.h2,{id:"8-epilog",children:"8. Epilog"}),"\n",(0,t.jsxs)(r.ul,{children:["\n",(0,t.jsx)(r.li,{children:"idempotent IaC \uc744 \ud1b5\ud574\uc11c infra provisioning \uad00\ub9ac\ub97c \ud574\ubcf4\uace0\uc790 \ud588\ub294\ub370, \uc2e4\uc81c \uc5c5\ubb34 \ud658\uacbd\uc5d0\uc11c\ub294 \ubcf4\uc548\uc801 \ubb38\uc81c\uc640 \ubc18\ubcf5 \uc5c5\ubb34\uc758 \ubd80\uc7ac \ub4f1\uc73c\ub85c \ub3c4\uc785 \ub418\uc9c0 \uc54a\uc558\ub2e4. side-project\ub85c \ubc16\uc5d0 \uacbd\ud5d8\ud560 \uc218 \uc5c6\uc744 \uac83 \uac19\ub2e4."}),"\n",(0,t.jsx)(r.li,{children:"\uc608\uc804 Hadoop \uc124\uce58\uc758 \ubcf5\uc7a1\ud568\uc744 \ud574\uacb0\ud558\uace0\uc790 ansible\ub85c IaC \uad6c\uc131\ud55c \uc801\uc774 \uc788\ub294\ub370, \uc790\ub8cc\ub97c \ub0a8\uae30\uc9c0 \uc54a\uc558\uc5c8\uace0, \uc774\uc804 \ud68c\uc0ac\uc758 \uacbd\ud5d8\uc774\ub77c \uc790\ub8cc\uac00 \uc5c6\uc5b4 \uae30\ub85d\uc73c\ub85c \ub0a8\uae30\uc9c0 \ubabb\ud574 \uc544\uc27d\ub2e4."}),"\n"]}),"\n",(0,t.jsx)(r.hr,{})]})}function h(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,t.jsx)(r,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},8453:(e,r,s)=>{s.d(r,{R:()=>d,x:()=>a});var n=s(6540);const t={},i=n.createContext(t);function d(e){const r=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:d(e.components),n.createElement(i.Provider,{value:r},e.children)}},3809:e=>{e.exports=JSON.parse('{"permalink":"/2024/10/26/sixth-terrform-aks","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2024-10-26-sixth-terrform-aks.md","source":"@site/blog/2024-10-26-sixth-terrform-aks.md","title":"AKS terraform\uc73c\ub85c \uc2dc\uc791\ud574\ubcf4\uae30","description":"summary","date":"2024-10-26T16:16:01.000Z","tags":[{"inline":true,"label":"Redis Cluster","permalink":"/tags/redis-cluster"},{"inline":true,"label":"kubernetes","permalink":"/tags/kubernetes"}],"readingTime":6.105,"hasTruncateMarker":true,"authors":[{"name":"Hanbyul Cho","title":"Engineer","url":"https://github.com/hansgun","page":{"permalink":"/authors/hansgun"},"socials":{"linkedin":"https://www.linkedin.com/in/hanbyulcho1/","github":"https://github.com/hansgun"},"imageURL":"https://github.com/hansgun.png","key":"hansgun"}],"frontMatter":{"layout":"single","title":"AKS terraform\uc73c\ub85c \uc2dc\uc791\ud574\ubcf4\uae30","date":"2024-10-26 16:16:01 -0600","categories":"work","tags":["Redis Cluster","kubernetes"],"author_profile":false,"toc":true,"toc_label":"On This Page","toc_icon":"cog","toc_position":"sticky","authors":["hansgun"]},"unlisted":false,"prevItem":{"title":"Redis A-S(Active-Standby/Master-Slave) cluster \uad6c\ucd95\uae30","permalink":"/2024/11/01/fifth-Redis-cluster"},"nextItem":{"title":"Authorizer Architecuture","permalink":"/2020/01/29/second-blog"}}')}}]);