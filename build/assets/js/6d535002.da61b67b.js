"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[3516],{4943:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>i,default:()=>d,frontMatter:()=>c,metadata:()=>o,toc:()=>a});const o=JSON.parse('{"id":"Azure_cloud/AWS_codecommit","title":"05. AWS commit message - Azure DevOps Board \uc5f0\ub3d9","description":"- \uce78\ubc18\ubcf4\ub4dc\uc5d0\uc11c commit history \uc5f0\ub3d9","source":"@site/docs/Azure_cloud/AWS_codecommit.md","sourceDirName":"Azure_cloud","slug":"/Azure_cloud/AWS_codecommit","permalink":"/docs/Azure_cloud/AWS_codecommit","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/Azure_cloud/AWS_codecommit.md","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"04. CI/CD","permalink":"/docs/Azure_cloud/CI_CD"},"next":{"title":"06. AWS , Azure","permalink":"/docs/Azure_cloud/AWS_Azure"}}');var s=n(4848),r=n(8453);const c={sidebar_position:5},i="05. AWS commit message - Azure DevOps Board \uc5f0\ub3d9",m={},a=[];function l(e){const t={code:"code",h1:"h1",header:"header",li:"li",ol:"ol",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"05-aws-commit-message---azure-devops-board-\uc5f0\ub3d9",children:"05. AWS commit message - Azure DevOps Board \uc5f0\ub3d9"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"\uce78\ubc18\ubcf4\ub4dc\uc5d0\uc11c commit history \uc5f0\ub3d9"}),"\n"]}),"\n",(0,s.jsx)(t.h1,{id:"1-aws-lambda-\uc0dd\uc131",children:"1. AWS Lambda \uc0dd\uc131"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"AWS \ucf58\uc194\uc5d0\uc11c Lambda \uc11c\ube44\uc2a4 \uc0dd\uc131"}),"\n",(0,s.jsxs)(t.li,{children:["AWS CodeCommit\uc5d0 \ub300\ud55c Trigger \uc0dd\uc131","\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"\uc774\uc804 \ub2e8\uacc4\uc5d0\uc11c \uc0dd\uc131\ud55c Lambda Function\uc73c\ub85c \uc774\ub3d9\ud558\uc5ec Add trigger \ub85c CodeCommit \uc9c0\uc815"}),"\n",(0,s.jsx)(t.li,{children:"\ub300\uc0c1 Repository \uc120\ud0dd \ud6c4, Events \uc5d0\uc11c All repository events\ub97c \uc120\ud0dd\ud558\uc5ec \uc801\uc6a9"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["AWS CodeCommit Repo ",(0,s.jsx)(t.strong,{children:"ARN"})," \ubcf5\uc0ac"]}),"\n",(0,s.jsxs)(t.li,{children:["AWS IAM\uc5d0 policy \uc0dd\uc131","\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Action\uc5d0\ub294 ",(0,s.jsx)(t.code,{children:"codecommit:Getcommit"})," \uc785\ub825"]}),"\n",(0,s.jsxs)(t.li,{children:["Resource \ud56d\ubaa9\uc5d0\ub294 \uc55e\uc5d0\uc11c \ubcf5\uc0ac\ud55c ",(0,s.jsx)(t.code,{children:"Repository APN"})," \uac12 \uc785\ub825"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["AWS IAM Role\uc5d0 Policy \ud560\ub2f9","\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Role \ud654\uba74\uc5d0\uc11c \uc774\uc804 \ub2e8\uacc4\uc5d0\uc11c \uc0dd\uc131\ud55c Lambda \uc774\ub984\uc73c\ub85c \uc0dd\uc131\ub41c Role \uc120\ud0dd"}),"\n",(0,s.jsx)(t.li,{children:"add permission\uc744 \ud074\ub9ad\ud6c4 Attach policies \ud074\ub9ad-\uc55e\uc5d0\uc11c \uc0dd\uc131\ud55c \uad8c\ud55c \ud560\ub2f9"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["AWS Lambda \ucf54\ub4dc \uc791\uc131","\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Lambda \uc11c\ube44\uc2a4 \ud398\uc774\uc9c0\uc5d0\uc11c Layers \ud56d\ubaa9 \ud074\ub9ad \ud6c4 Create layer \ud074\ub9ad"}),"\n",(0,s.jsxs)(t.li,{children:["\uc774\ub984 \uc9c0\uc815 \ud6c4 Update \ubc84\ud2bc \ud074\ub9ad \ud6c4 ",(0,s.jsx)(t.strong,{children:"axios.zip"})," \ucd94\uac00"]}),"\n",(0,s.jsx)(t.li,{children:"Specify an ARN \uccb4\ud06c\ud558\uc5ec \uc55e\uc5d0\uc11c \ubcf5\uc0ac\ud55c ARN \uac12 \uc785\ub825 \ud6c4 Verify \ud558\uc5ec Add"}),"\n",(0,s.jsx)(t.li,{children:"Lambda Function \uc544\ub798 Code source \ud56d\ubaa9\uc5d0 \ub2e4\uc74c \ucf54\ub4dc\ub97c \ubd99\uc5ec \ub123\uace0 Deploy \uc2e4\ud589"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:'const AWS = require(\'aws-sdk\');\nconst axios = require(\'axios\');\n\nlet commit_last;\n\nexports.handler= async(event, context) => {\n\tconsole.log("Entier Events:");\n\tconsole.og(JSON.stringfy(event, null,2)); \n\tconst reference = evnet.Records[0].codecommit.referrences[0];\n\tif (reference.deleted || reference.create) {\n\t\tconsole.log("\uc885\ub8cc \uc870\uac74 \ucda9\uc871 : \uc0ad\uc81c\ub418\uc5c8\uac70\ub098 \uc0dd\uc131\ub41c \ub808\ud37c\ub7f0\uc2a4 \uc785\ub2c8\ub2e4.");\n\t\treturn;\n\t}\n\tif (commit_last === event.Records[0].codecommit.referrences[0].commit) {\n\t\tconsole.log("\uc774\uc804 commit_id\uc640 \uac19\uc2b5\ub2c8\ub2e4. \uc885\ub8cc\ud569\ub2c8\ub2e4. ");\n\t\treturn \n\t}\n\tlet branch_name, repository, commit_id, commit_num, author_name, commit_url, commit_message = null;\n\n\ttry {\n\t\tlet references = event.Records[0].codecommit.references.map(function(reference) {reference.ref()});\n\t\tconsole.log("References:", references);\n\t\tlet ref = references[0].split(\'/\');\n\t\tbranch_name = ref[2];\n\t\tconsole.log(branch_name);\n\t\n\t\trepository = event.Records[0].evnetSourceARN.split(":")[5];\n\t\tconsole.log("Repository:", repository);\n\t\t\n\t\tcommit_id = event.Records[0].codecommit.referrences[0].commit;\n\t\tcommit_last = commit_id;\n\t\t\n\t\tconst codecommit = new AWS.CodeCommit();\n\t\tconst params = {\n\t\t\tcommitId: commit_id,\n\t\t\trepositoryName : repository\n\t\t};\n\t\tconst data = await codecommit.getCommit(params).promise();\n\t\tcommit_num = data.commit.author.email;\n\t\tconsole.log("GetCommit API \uc751\ub2f5 \ub370\uc774\ud130: ");\n\t\tconsole.log(JSON.stringify(data,null,2));\n\t\tconsole.log("Commit Message:", data.commit.author.email);\n\t\tconsole.log("Author:", data.commit.author.name);\n\t\tconsole.log("WorkItem Num:", commit_num);\n\t\tauthor_name = data.commit.author.name;\n\t\tcommit_message = data.commit.message;\n\t\tcommit_url = `https://${process.env.AWS_REGION}.console.aws.amazon.com/codesuite/codecommit/repositories/${repository}/commit/${commit_id}`;\n\t\tconst message = {\n\t\t\trepoName: repository,\n\t\t\tcommitId: commit_id,\n\t\t\tcommitNum: commit_num,\n\t\t\tauthorNmae: autho_name,\n\t\t\tcommitURL: commit_url,\n\t\t\tbranchName: branch_name, \n\t\t\tcommitMessage: commit_message\n\t\t};\n\t\tconst logicAppUrl = "";\n\t\tconst postData = JSON.stringify(message);\n\t\t\n\t\ttry { \n\t\t\tconst response = await axios.post(logicAppUrl, postDate);\n\t\t\t\n\t\t\tif (response.status === 200) {\n\t\t\t\tconsole.log()\n\t\t\t}\n\t\t}\n\t}\n}\n'})})]})}function d(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>c,x:()=>i});var o=n(6540);const s={},r=o.createContext(s);function c(e){const t=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),o.createElement(r.Provider,{value:t},e.children)}}}]);